(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))e(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const l of n.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&e(l)}).observe(document,{childList:!0,subtree:!0});function s(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function e(i){if(i.ep)return;i.ep=!0;const n=s(i);fetch(i.href,n)}})();const _=JSON.parse('[{"id":"odpt.BusstopPole:KokusaiKogyoBus.MarugasakiHinomishita.2086.1","title":"丸ヶ崎火の見下","number":"1","lat":35.95695,"lon":139.6533},{"id":"odpt.BusstopPole:KokusaiKogyoBus.MinaminakanoChuuou.2237.2","title":"南中野中央","number":"2","lat":35.90932,"lon":139.6556},{"id":"odpt.BusstopPole:KokusaiKogyoBus.OomiyaEkiHigashiguchi.2001.11","title":"大宮駅東口","number":"11","lat":35.9069,"lon":139.6275},{"id":"odpt.BusstopPole:KokusaiKogyoBus.SaGiSanKinenKouen.2027.1","title":"さぎ山記念公園","number":"1","lat":35.90875,"lon":139.6999},{"id":"odpt.BusstopPole:KokusaiKogyoBus.Shibakawa.2124.2","title":"芝川","number":"2","lat":35.91742,"lon":139.644},{"id":"odpt.BusstopPole:KokusaiKogyoBus.HorinouchiKyou.2008.99","title":"堀の内橋","number":"99","lat":35.91084,"lon":139.6423},{"id":"odpt.BusstopPole:KokusaiKogyoBus.HorinouchiKyou.2008.1","title":"堀の内橋","number":"1","lat":35.91084,"lon":139.6423},{"id":"odpt.BusstopPole:KokusaiKogyoBus.Shibakawa.2124.1","title":"芝川","number":"1","lat":35.91693,"lon":139.6431},{"id":"odpt.BusstopPole:KokusaiKogyoBus.HigashioomiyaEki.2081.2","title":"東大宮駅","number":"2","lat":35.9488,"lon":139.6407},{"id":"odpt.BusstopPole:KokusaiKogyoBus.Takahana.2041.1","title":"高鼻","number":"1","lat":35.90307,"lon":139.651},{"id":"odpt.BusstopPole:KokusaiKogyoBus.KukiEki.1748.99","title":"久喜駅","number":"99","lat":null,"lon":null},{"id":"odpt.BusstopPole:KokusaiKogyoBus.OowadaIchiChoume.2073.1","title":"大和田一丁目","number":"1","lat":35.9253,"lon":139.6473},{"id":"odpt.BusstopPole:KokusaiKogyoBus.Marugasaki.2084.1","title":"丸ヶ崎","number":"1","lat":35.95365,"lon":139.6498},{"id":"odpt.BusstopPole:KokusaiKogyoBus.OowadaKouen.2129.2","title":"大和田公園","number":"2","lat":35.92339,"lon":139.6405},{"id":"odpt.BusstopPole:KokusaiKogyoBus.DanchiHigashi.2051.1","title":"団地東（東新井団地）","number":"1","lat":35.9063,"lon":139.6628},{"id":"odpt.BusstopPole:KokusaiKogyoBus.HigashiboriNoUchi.2122.1","title":"東堀の内","number":"1","lat":35.91353,"lon":139.6375},{"id":"odpt.BusstopPole:KokusaiKogyoBus.JunouNiChoume.2128.1","title":"寿能二丁目","number":"1","lat":35.922,"lon":139.6375},{"id":"odpt.BusstopPole:KokusaiKogyoBus.KatayanagiShisho.2017.3","title":"片柳支所","number":"3","lat":35.90972,"lon":139.6693},{"id":"odpt.BusstopPole:KokusaiKogyoBus.Minaminakano.2013.1","title":"南中野","number":"1","lat":35.90917,"lon":139.6573},{"id":"odpt.BusstopPole:KokusaiKogyoBus.NishisambanGai.2092.2","title":"西三番街","number":"2","lat":35.95738,"lon":139.663},{"id":"odpt.BusstopPole:KokusaiKogyoBus.HigashiichibanGai.2088.2","title":"東一番街","number":"2","lat":35.95405,"lon":139.6688},{"id":"odpt.BusstopPole:KokusaiKogyoBus.HasudaNishishinjuku.1744.1","title":"蓮田西新宿","number":"1","lat":null,"lon":null},{"id":"odpt.BusstopPole:KokusaiKogyoBus.NakayamaJinja.2047.1","title":"中山神社","number":"1","lat":35.9002,"lon":139.6611},{"id":"odpt.BusstopPole:KokusaiKogyoBus.KatayanagiShisho.2017.1","title":"片柳支所","number":"1","lat":35.90923,"lon":139.6699},{"id":"odpt.BusstopPole:KokusaiKogyoBus.HigashinibanGai.2090.2","title":"東二番街","number":"2","lat":35.95698,"lon":139.67},{"id":"odpt.BusstopPole:KokusaiKogyoBus.UrawagakuinKoukouIriguchi.2030.1","title":"浦和学院高校入口","number":"1","lat":35.90208,"lon":139.7037},{"id":"odpt.BusstopPole:KokusaiKogyoBus.AmanumaIchiChoume.2006.1","title":"天沼一丁目","number":"1","lat":35.90888,"lon":139.6394},{"id":"odpt.BusstopPole:KokusaiKogyoBus.NichidaiMae.2014.3","title":"日大前","number":"3","lat":35.90915,"lon":139.6612},{"id":"odpt.BusstopPole:KokusaiKogyoBus.TakaraJouInKa.2042.1","title":"宝乗院下","number":"1","lat":35.90154,"lon":139.6516},{"id":"odpt.BusstopPole:KokusaiKogyoBus.Nishinakano.2012.2","title":"西中野","number":"2","lat":35.90982,"lon":139.6527},{"id":"odpt.BusstopPole:KokusaiKogyoBus.Nakamaru.2070.2","title":"中丸","number":"2","lat":35.91505,"lon":139.6523},{"id":"odpt.BusstopPole:KokusaiKogyoBus.KashimaKyou.2123.2","title":"鹿島橋","number":"2","lat":35.91435,"lon":139.6392},{"id":"odpt.BusstopPole:KokusaiKogyoBus.SaitamaHigashiEigyouSho.1706.99","title":"さいたま東営業所","number":"99","lat":35.9107893287287,"lon":139.69513485304492},{"id":"odpt.BusstopPole:KokusaiKogyoBus.NakagawaSakagami.2011.1","title":"中川坂上","number":"1","lat":35.91113,"lon":139.6509},{"id":"odpt.BusstopPole:KokusaiKogyoBus.ShiraokaNyu-taunIriguchi.1746.1","title":"白岡ニュータウン入口","number":"1","lat":null,"lon":null},{"id":"odpt.BusstopPole:KokusaiKogyoBus.ShirubeMori.2072.2","title":"導守","number":"2","lat":35.92038,"lon":139.6509},{"id":"odpt.BusstopPole:KokusaiKogyoBus.IsagoMachi.2078.1","title":"砂町","number":"1","lat":35.94090314557571,"lon":139.6444750700329},{"id":"odpt.BusstopPole:KokusaiKogyoBus.NodaHouei.2026.1","title":"野田宝永","number":"1","lat":35.90875,"lon":139.6962},{"id":"odpt.BusstopPole:KokusaiKogyoBus.HoriNoUchi.2120.1","title":"堀の内","number":"1","lat":35.91212,"lon":139.6338},{"id":"odpt.BusstopPole:KokusaiKogyoBus.AmanumaMachi.2009.2","title":"天沼町","number":"2","lat":35.91135,"lon":139.645},{"id":"odpt.BusstopPole:KokusaiKogyoBus.NegiWa.2022.1","title":"根木輪","number":"1","lat":35.90403,"lon":139.6844},{"id":"odpt.BusstopPole:KokusaiKogyoBus.NichidaiMae.2014.99","title":"日大前","number":"99","lat":35.909644477840736,"lon":139.6616593702403},{"id":"odpt.BusstopPole:KokusaiKogyoBus.ShibakawaShimbashi.2010.2","title":"芝川新橋","number":"2","lat":35.91155,"lon":139.6481},{"id":"odpt.BusstopPole:KokusaiKogyoBus.UrawaHigashiKoukouIriguchi.2028.1","title":"浦和東高校入口","number":"1","lat":35.90647,"lon":139.7022},{"id":"odpt.BusstopPole:KokusaiKogyoBus.HoriNoUchi.2120.3","title":"堀の内","number":"3","lat":35.91203,"lon":139.635},{"id":"odpt.BusstopPole:KokusaiKogyoBus.IsagoMachiHarayama.2080.2","title":"砂町原山","number":"2","lat":35.9478,"lon":139.6445},{"id":"odpt.BusstopPole:KokusaiKogyoBus.SomeyaOriKaeJou.2067.99","title":"染谷折返場","number":"99","lat":35.9153,"lon":139.6826},{"id":"odpt.BusstopPole:KokusaiKogyoBus.OomiyaSakka-JouMae.2118.2","title":"大宮サッカー場前","number":"2","lat":35.91712,"lon":139.6355},{"id":"odpt.BusstopPole:KokusaiKogyoBus.HorinouchiKyou.2008.2","title":"堀の内橋","number":"2","lat":35.91063,"lon":139.6422},{"id":"odpt.BusstopPole:KokusaiKogyoBus.Nishiyama.1707.1","title":"西山","number":"1","lat":35.90253,"lon":139.6779},{"id":"odpt.BusstopPole:KokusaiKogyoBus.Futatsuya.1732.1","title":"二ツ家","number":"1","lat":null,"lon":null},{"id":"odpt.BusstopPole:KokusaiKogyoBus.HigashisambanGai.2089.2","title":"東三番街","number":"2","lat":35.95496,"lon":139.6706},{"id":"odpt.BusstopPole:KokusaiKogyoBus.KounosuEkiHigashiguchi.1734.99","title":"鴻巣駅東口","number":"99","lat":null,"lon":null},{"id":"odpt.BusstopPole:KokusaiKogyoBus.FukaSakuchuu.2087.99","title":"深作中","number":"99","lat":35.9529,"lon":139.6663},{"id":"odpt.BusstopPole:KokusaiKogyoBus.Nakanoda.2032.1","title":"中野田","number":"1","lat":35.89779,"lon":139.7079},{"id":"odpt.BusstopPole:KokusaiKogyoBus.ToubuRisaikuruSenta-.2063.99","title":"東部リサイクルセンター","number":"99","lat":35.92852,"lon":139.6881},{"id":"odpt.BusstopPole:KokusaiKogyoBus.OoyaKeneiJuutaku.2058.99","title":"大谷県営住宅","number":"99","lat":35.92333,"lon":139.6724},{"id":"odpt.BusstopPole:KokusaiKogyoBus.Nakamaru.2070.1","title":"中丸","number":"1","lat":35.9155,"lon":139.6522},{"id":"odpt.BusstopPole:KokusaiKogyoBus.AgeoEkiHigashiguchi.1729.1","title":"上尾駅東口","number":"1","lat":null,"lon":null},{"id":"odpt.BusstopPole:KokusaiKogyoBus.ShimekiriKyou.2025.1","title":"締切橋","number":"1","lat":35.9077,"lon":139.6944},{"id":"odpt.BusstopPole:KokusaiKogyoBus.Nishiura.2049.1","title":"西浦","number":"1","lat":35.90508,"lon":139.6569},{"id":"odpt.BusstopPole:KokusaiKogyoBus.KatayanagiShougakkou.2018.1","title":"片柳小学校","number":"1","lat":35.9093,"lon":139.6716},{"id":"odpt.BusstopPole:KokusaiKogyoBus.NodaShougakkou.2031.1","title":"野田小学校","number":"1","lat":35.90017,"lon":139.7052},{"id":"odpt.BusstopPole:KokusaiKogyoBus.Minaminakano.2013.2","title":"南中野","number":"2","lat":35.90903,"lon":139.659},{"id":"odpt.BusstopPole:KokusaiKogyoBus.UrawaHigashiKoukou.2068.99","title":"浦和東高校","number":"99","lat":35.90997,"lon":139.7067},{"id":"odpt.BusstopPole:KokusaiKogyoBus.Oowada.2125.2","title":"大和田","number":"2","lat":35.91927,"lon":139.648},{"id":"odpt.BusstopPole:KokusaiKogyoBus.A-banMiRai.2093.2","title":"アーバンみらい（春野図書館）","number":"2","lat":35.95868,"lon":139.6606},{"id":"odpt.BusstopPole:KokusaiKogyoBus.OwadaEkiIriguchi.2075.1","title":"大和田駅入口","number":"1","lat":null,"lon":null},{"id":"odpt.BusstopPole:KokusaiKogyoBus.InaSakae.1742.1","title":"伊奈栄","number":"1","lat":null,"lon":null},{"id":"odpt.BusstopPole:KokusaiKogyoBus.KashimaKyou.2123.1","title":"鹿島橋","number":"1","lat":35.91427,"lon":139.639},{"id":"odpt.BusstopPole:KokusaiKogyoBus.SomeyaKita.2066.1","title":"染谷北","number":"1","lat":35.91182,"lon":139.6839},{"id":"odpt.BusstopPole:KokusaiKogyoBus.SomeyaMinami.2064.1","title":"染谷南","number":"1","lat":35.90722,"lon":139.6872},{"id":"odpt.BusstopPole:KokusaiKogyoBus.IchiNoKubo.2254.2","title":"一ノ久保","number":"2","lat":35.91267,"lon":139.6545},{"id":"odpt.BusstopPole:KokusaiKogyoBus.SomeyaIriguchi.2019.1","title":"染谷入口","number":"1","lat":35.90895,"lon":139.6743},{"id":"odpt.BusstopPole:KokusaiKogyoBus.HikawaSandou.2003.2","title":"氷川参道","number":"2","lat":35.9075,"lon":139.6315},{"id":"odpt.BusstopPole:KokusaiKogyoBus.HikawaSandou.2003.1","title":"氷川参道","number":"1","lat":35.90759,"lon":139.6316},{"id":"odpt.BusstopPole:KokusaiKogyoBus.KouHanaNiChoume.2119.2","title":"高鼻二丁目","number":"2","lat":35.91327,"lon":139.6342},{"id":"odpt.BusstopPole:KokusaiKogyoBus.NichidaiMae.2014.1","title":"日大前","number":"1","lat":35.90945,"lon":139.6617},{"id":"odpt.BusstopPole:KokusaiKogyoBus.Minaminakano.2013.3","title":"南中野","number":"3","lat":35.90897,"lon":139.6572},{"id":"odpt.BusstopPole:KokusaiKogyoBus.Momijigaoka.2076.1","title":"紅葉ヶ丘","number":"1","lat":36.03148570581217,"lon":139.63277509379128},{"id":"odpt.BusstopPole:KokusaiKogyoBus.HigashioomiyaGoChoume.2079.1","title":"東大宮五丁目","number":"1","lat":35.948830124612,"lon":139.6406673131366},{"id":"odpt.BusstopPole:KokusaiKogyoBus.UrawagakuinKoukou.2033.99","title":"浦和学院高校","number":"99","lat":35.90255,"lon":139.705},{"id":"odpt.BusstopPole:KokusaiKogyoBus.Hizako.2060.2","title":"膝子","number":"2","lat":35.92327,"lon":139.6827},{"id":"odpt.BusstopPole:KokusaiKogyoBus.OowadaSakagami.2130.1","title":"大和田坂上","number":"1","lat":35.92495,"lon":139.6449},{"id":"odpt.BusstopPole:KokusaiKogyoBus.ShirubeMori.2072.4","title":"導守","number":"4","lat":35.92045,"lon":139.6503},{"id":"odpt.BusstopPole:KokusaiKogyoBus.HorinouchiSanChoume.2121.2","title":"堀の内三丁目","number":"2","lat":35.91278,"lon":139.6361},{"id":"odpt.BusstopPole:KokusaiKogyoBus.TaishouZaka.2040.1","title":"大正坂","number":"1","lat":35.9058,"lon":139.6502},{"id":"odpt.BusstopPole:KokusaiKogyoBus.HoriNoUchi.2120.2","title":"堀の内","number":"2","lat":35.91125,"lon":139.6338},{"id":"odpt.BusstopPole:KokusaiKogyoBus.SomeyaNaka.2065.1","title":"染谷中","number":"1","lat":35.90963,"lon":139.6858},{"id":"odpt.BusstopPole:KokusaiKogyoBus.ShiraokaEki.1745.1","title":"白岡駅","number":"1","lat":null,"lon":null},{"id":"odpt.BusstopPole:KokusaiKogyoBus.Kamiyamaguchi.2043.1","title":"上山口","number":"1","lat":35.8996,"lon":139.6524},{"id":"odpt.BusstopPole:KokusaiKogyoBus.KatayanagiYuubinKyoku.2016.1","title":"片柳郵便局","number":"1","lat":35.90937,"lon":139.667},{"id":"odpt.BusstopPole:KokusaiKogyoBus.AzumamachiIchiChoume.2004.1","title":"東町一丁目（大宮区）","number":"1","lat":35.9077,"lon":139.6338},{"id":"odpt.BusstopPole:KokusaiKogyoBus.KouOoya.2056.1","title":"向大谷","number":"1","lat":35.91715,"lon":139.6707},{"id":"odpt.BusstopPole:KokusaiKogyoBus.MisakiDai.2024.1","title":"三崎台","number":"1","lat":35.90569,"lon":139.6907},{"id":"odpt.BusstopPole:KokusaiKogyoBus.Famiri-TaunNishi.2095.2","title":"ファミリータウン西","number":"2","lat":35.96105,"lon":139.6568},{"id":"odpt.BusstopPole:KokusaiKogyoBus.OoyaShimoda.2059.1","title":"大谷下田","number":"1","lat":35.91993,"lon":139.6761},{"id":"odpt.BusstopPole:KokusaiKogyoBus.NakagawaSakagami.2011.2","title":"中川坂上","number":"2","lat":35.91168,"lon":139.6503},{"id":"odpt.BusstopPole:KokusaiKogyoBus.OomiyaEkiHigashiguchi.2001.7","title":"大宮駅東口","number":"7","lat":35.9066,"lon":139.6259},{"id":"odpt.BusstopPole:KokusaiKogyoBus.Yahata.2038.1","title":"八幡","number":"1","lat":35.90835,"lon":139.6524},{"id":"odpt.BusstopPole:KokusaiKogyoBus.MarugasakiIppommatsu.2082.1","title":"丸ヶ崎一本松","number":"1","lat":35.95018,"lon":139.6466},{"id":"odpt.BusstopPole:KokusaiKogyoBus.OkegawaEkiIriguchi.1731.1","title":"桶川駅入口","number":"1","lat":null,"lon":null},{"id":"odpt.BusstopPole:KokusaiKogyoBus.HarunoShougakkou.2091.2","title":"春野小学校","number":"2","lat":35.9576,"lon":139.6684},{"id":"odpt.BusstopPole:KokusaiKogyoBus.DaiMiyahigashiKoukou.2062.1","title":"大宮東高校","number":"1","lat":35.92792,"lon":139.6851},{"id":"odpt.BusstopPole:KokusaiKogyoBus.DetoKyou.2085.1","title":"出戸橋","number":"1","lat":35.95561,"lon":139.6512},{"id":"odpt.BusstopPole:KokusaiKogyoBus.AmanumaMachi.2009.1","title":"天沼町","number":"1","lat":35.91143,"lon":139.6454},{"id":"odpt.BusstopPole:KokusaiKogyoBus.OomiyaEkiHigashiguchi.2001.6","title":"大宮駅東口","number":"6","lat":35.90655,"lon":139.6257},{"id":"odpt.BusstopPole:KokusaiKogyoBus.HoriNoUchi.2120.4","title":"堀の内","number":"4","lat":35.91192,"lon":139.6347},{"id":"odpt.BusstopPole:KokusaiKogyoBus.DaiMiyahigashiKoukouIriguchi.2061.2","title":"大宮東高校入口","number":"2","lat":35.92555,"lon":139.6806},{"id":"odpt.BusstopPole:KokusaiKogyoBus.OomiyaShougyou.2074.1","title":"大宮商業","number":"1","lat":35.92640822478891,"lon":139.64669518739188},{"id":"odpt.BusstopPole:KokusaiKogyoBus.AmanumaIchiChoume.2006.2","title":"天沼一丁目","number":"2","lat":35.90843,"lon":139.6385},{"id":"odpt.BusstopPole:KokusaiKogyoBus.OomiyakouenIriguchi.2126.1","title":"大宮公園入口","number":"1","lat":35.91955,"lon":139.6354},{"id":"odpt.BusstopPole:KokusaiKogyoBus.NakamaruKa.2039.1","title":"中丸下","number":"1","lat":35.91003,"lon":139.6493},{"id":"odpt.BusstopPole:KokusaiKogyoBus.Namburyoutsuji.1529.1","title":"南部領辻","number":"1","lat":35.8952,"lon":139.7112},{"id":"odpt.BusstopPole:KokusaiKogyoBus.Koushinduka.2015.1","title":"庚申塚","number":"1","lat":35.90972,"lon":139.6641},{"id":"odpt.BusstopPole:KokusaiKogyoBus.Daiyama.2029.1","title":"代山","number":"1","lat":35.90487,"lon":139.7027},{"id":"odpt.BusstopPole:KokusaiKogyoBus.HigashiboriNoUchi.2122.2","title":"東堀の内","number":"2","lat":35.91347,"lon":139.6375},{"id":"odpt.BusstopPole:KokusaiKogyoBus.MiyaharaEkiIriguchi.1728.1","title":"宮原駅入口","number":"1","lat":null,"lon":null},{"id":"odpt.BusstopPole:KokusaiKogyoBus.DanchiMinami.2052.1","title":"団地南（東新井団地）","number":"1","lat":35.90368,"lon":139.6641},{"id":"odpt.BusstopPole:KokusaiKogyoBus.HasudaEkiNishiguchi.1743.1","title":"蓮田駅西口","number":"1","lat":null,"lon":null},{"id":"odpt.BusstopPole:KokusaiKogyoBus.IsagoMachiHarayama.2080.1","title":"砂町原山","number":"1","lat":35.94776,"lon":139.6444},{"id":"odpt.BusstopPole:KokusaiKogyoBus.ShibakawaShimbashi.2010.1","title":"芝川新橋","number":"1","lat":35.91157,"lon":139.6479},{"id":"odpt.BusstopPole:KokusaiKogyoBus.AzumamachiNiChoume.2204.2","title":"東町二丁目（大宮区）","number":"2","lat":35.909,"lon":139.6341},{"id":"odpt.BusstopPole:KokusaiKogyoBus.SomeyaShindou.2023.1","title":"染谷新道","number":"1","lat":35.90492,"lon":139.6872},{"id":"odpt.BusstopPole:KokusaiKogyoBus.KitamotoEkiIriguchi.1733.1","title":"北本駅入口","number":"1","lat":null,"lon":null},{"id":"odpt.BusstopPole:KokusaiKogyoBus.MinamiboriNoUchi.2005.1","title":"南堀の内","number":"1","lat":35.90777,"lon":139.6366},{"id":"odpt.BusstopPole:KokusaiKogyoBus.ShinshiraokaEki.1747.1","title":"新白岡駅","number":"1","lat":null,"lon":null},{"id":"odpt.BusstopPole:KokusaiKogyoBus.OowadaIchiChoume.2073.2","title":"大和田一丁目","number":"2","lat":35.92493,"lon":139.6475},{"id":"odpt.BusstopPole:KokusaiKogyoBus.OosunaDochuuGakkou.2077.1","title":"大砂土中学校","number":"1","lat":35.93696283821514,"lon":139.6458041033662},{"id":"odpt.BusstopPole:KokusaiKogyoBus.Nishinakano.2012.1","title":"西中野","number":"1","lat":35.90982,"lon":139.653},{"id":"odpt.BusstopPole:KokusaiKogyoBus.Nakagawa.2037.1","title":"中川","number":"1","lat":35.90815,"lon":139.6498},{"id":"odpt.BusstopPole:KokusaiKogyoBus.Miyamae.2046.1","title":"宮前","number":"1","lat":35.89878,"lon":139.6621},{"id":"odpt.BusstopPole:KokusaiKogyoBus.YonoDou.2044.1","title":"与野道","number":"1","lat":35.89845,"lon":139.6548},{"id":"odpt.BusstopPole:KokusaiKogyoBus.JichiidaiIryouSenta-.2036.1","title":"自治医大医療センター","number":"1","lat":35.90703,"lon":139.6462},{"id":"odpt.BusstopPole:KokusaiKogyoBus.EnzouInKa.2045.1","title":"円蔵院下","number":"1","lat":35.89795,"lon":139.6572},{"id":"odpt.BusstopPole:KokusaiKogyoBus.ShiritsuByouin.1577.99","title":"市立病院（さいたま市緑区）","number":"99","lat":35.89104,"lon":139.6783},{"id":"odpt.BusstopPole:KokusaiKogyoBus.JichiidaiIryouSenta-Iriguchi.2035.1","title":"自治医大医療センター入口","number":"1","lat":35.90802,"lon":139.6462},{"id":"odpt.BusstopPole:KokusaiKogyoBus.IchiNoKubo.2254.1","title":"一ノ久保","number":"1","lat":35.91257,"lon":139.6545},{"id":"odpt.BusstopPole:KokusaiKogyoBus.HorinouchiSanChoume.2121.1","title":"堀の内三丁目","number":"1","lat":35.9127,"lon":139.6361},{"id":"odpt.BusstopPole:KokusaiKogyoBus.Gembashinden.2251.1","title":"玄蕃新田","number":"1","lat":35.89012,"lon":139.7168},{"id":"odpt.BusstopPole:KokusaiKogyoBus.OowadaSakagami.2130.2","title":"大和田坂上","number":"2","lat":35.92492,"lon":139.6449},{"id":"odpt.BusstopPole:KokusaiKogyoBus.HigashioomiyaRokuChoume.2083.1","title":"東大宮六丁目","number":"1","lat":35.95175,"lon":139.6478},{"id":"odpt.BusstopPole:KokusaiKogyoBus.Sanson.2021.1","title":"山村","number":"1","lat":35.90483,"lon":139.6795},{"id":"odpt.BusstopPole:KokusaiKogyoBus.OomiyaEkiHigashiguchi.2001.9","title":"大宮駅東口","number":"9","lat":35.90675,"lon":139.6265},{"id":"odpt.BusstopPole:KokusaiKogyoBus.OomiyaOokadoMachi.2002.1","title":"大宮大門町","number":"1","lat":35.90715,"lon":139.6288},{"id":"odpt.BusstopPole:KokusaiKogyoBus.Takai.2069.1","title":"高井","number":"1","lat":35.91317,"lon":139.6527},{"id":"odpt.BusstopPole:KokusaiKogyoBus.AzumamachiNiChoume.2204.1","title":"東町二丁目（大宮区）","number":"1","lat":35.90928,"lon":139.6341},{"id":"odpt.BusstopPole:KokusaiKogyoBus.OomiyaEkiHigashiguchi.2001.99","title":"大宮駅東口","number":"99","lat":35.90647,"lon":139.6259},{"id":"odpt.BusstopPole:KokusaiKogyoBus.OguraShiraoka.2054.1","title":"御蔵白岡","number":"1","lat":35.91137,"lon":139.6692},{"id":"odpt.BusstopPole:KokusaiKogyoBus.Komatsudai.2055.1","title":"小松台","number":"1","lat":35.91528,"lon":139.6702},{"id":"odpt.BusstopPole:KokusaiKogyoBus.Takai.2069.2","title":"高井","number":"2","lat":35.91319,"lon":139.6528},{"id":"odpt.BusstopPole:KokusaiKogyoBus.JunouJuutaku.2127.2","title":"寿能住宅","number":"2","lat":35.9212,"lon":139.6353},{"id":"odpt.BusstopPole:KokusaiKogyoBus.MinamiOotoriDaiJuutaku.2253.2","title":"南鳳台住宅","number":"2","lat":35.91228,"lon":139.6567},{"id":"odpt.BusstopPole:KokusaiKogyoBus.MinamiOotoriDaiJuutaku.2253.1","title":"南鳳台住宅","number":"1","lat":35.9122,"lon":139.6567},{"id":"odpt.BusstopPole:KokusaiKogyoBus.Minamidai.1578.1","title":"南台","number":"1","lat":35.89855,"lon":139.6791},{"id":"odpt.BusstopPole:KokusaiKogyoBus.Oowada.2125.1","title":"大和田","number":"1","lat":35.9194,"lon":139.6482},{"id":"odpt.BusstopPole:KokusaiKogyoBus.KitaAgeoEkiIriguchi.1730.1","title":"北上尾駅入口","number":"1","lat":null,"lon":null},{"id":"odpt.BusstopPole:KokusaiKogyoBus.HorinouchiIchiChoume.2007.2","title":"堀の内一丁目","number":"2","lat":35.90912,"lon":139.6402},{"id":"odpt.BusstopPole:KokusaiKogyoBus.OomiyakouenIriguchi.2126.2","title":"大宮公園入口","number":"2","lat":35.91917,"lon":139.6356},{"id":"odpt.BusstopPole:KokusaiKogyoBus.MinamiboriNoUchi.2005.2","title":"南堀の内","number":"2","lat":35.90768,"lon":139.6363},{"id":"odpt.BusstopPole:KokusaiKogyoBus.UrawaDaigakuIriguchi.1528.1","title":"浦和大学入口","number":"1","lat":35.8922,"lon":139.7146},{"id":"odpt.BusstopPole:KokusaiKogyoBus.ShirubeMori.2072.1","title":"導守","number":"1","lat":35.92022,"lon":139.6509},{"id":"odpt.BusstopPole:KokusaiKogyoBus.HigashiaraiDanchi.2053.99","title":"東新井団地","number":"99","lat":35.90528,"lon":139.6605},{"id":"odpt.BusstopPole:KokusaiKogyoBus.OomiyaEkiHigashiguchi.2001.4","title":"大宮駅東口","number":"4","lat":35.9063,"lon":139.6252},{"id":"odpt.BusstopPole:KokusaiKogyoBus.Ooya.2057.1","title":"大谷","number":"1","lat":35.91858,"lon":139.6712},{"id":"odpt.BusstopPole:KokusaiKogyoBus.JunouNiChoume.2128.2","title":"寿能二丁目","number":"2","lat":35.922,"lon":139.6374},{"id":"odpt.BusstopPole:KokusaiKogyoBus.HigashioomiyaEkiNishiguchi.1741.1","title":"東大宮駅西口","number":"1","lat":35.9488172103965,"lon":139.63992950989916},{"id":"odpt.BusstopPole:KokusaiKogyoBus.NakagawaTenjin.2048.1","title":"中川天神","number":"1","lat":35.90294,"lon":139.6588},{"id":"odpt.BusstopPole:KokusaiKogyoBus.OowadaKouen.2129.1","title":"大和田公園","number":"1","lat":35.92339,"lon":139.6404},{"id":"odpt.BusstopPole:KokusaiKogyoBus.TakaiKita.2071.1","title":"高井北","number":"1","lat":35.91757,"lon":139.652},{"id":"odpt.BusstopPole:KokusaiKogyoBus.Ueyama.2020.1","title":"上山","number":"1","lat":35.90665,"lon":139.6763},{"id":"odpt.BusstopPole:KokusaiKogyoBus.AmanumaMachi.2009.99","title":"天沼町","number":"99","lat":35.91143,"lon":139.6454},{"id":"odpt.BusstopPole:KokusaiKogyoBus.JunouJuutaku.2127.1","title":"寿能住宅","number":"1","lat":35.9213,"lon":139.6351},{"id":"odpt.BusstopPole:KokusaiKogyoBus.KouHanaNiChoume.2119.1","title":"高鼻二丁目","number":"1","lat":35.91402,"lon":139.6344},{"id":"odpt.BusstopPole:KokusaiKogyoBus.AmanumaChuuouDoori.2034.1","title":"天沼中央通り","number":"1","lat":35.90782,"lon":139.6404},{"id":"odpt.BusstopPole:KokusaiKogyoBus.Famiri-TaunIriguchi.2096.2","title":"ファミリータウン入口","number":"2","lat":35.9608,"lon":139.6539},{"id":"odpt.BusstopPole:KokusaiKogyoBus.OomiyaSakka-JouMae.2118.1","title":"大宮サッカー場前","number":"1","lat":35.91758,"lon":139.6354},{"id":"odpt.BusstopPole:KokusaiKogyoBus.Puromuna-doChuuou.2094.2","title":"プロムナード中央","number":"2","lat":35.95953,"lon":139.6594},{"id":"odpt.BusstopPole:KokusaiKogyoBus.JichiidaiIryouSenta-.2036.99","title":"自治医大医療センター","number":"99","lat":35.90703,"lon":139.6463},{"id":"odpt.BusstopPole:KokusaiKogyoBus.Nishiura.2049.99","title":"西浦","number":"99","lat":35.90512,"lon":139.657},{"id":"odpt.BusstopPole:KokusaiKogyoBus.HorinouchiIchiChoume.2007.1","title":"堀の内一丁目","number":"1","lat":35.9094,"lon":139.6405},{"id":"odpt.BusstopPole:KokusaiKogyoBus.NakagawaChuuouDoori.2050.1","title":"中川中央通り","number":"1","lat":35.908,"lon":139.6544},{"id":"odpt.BusstopPole:KokusaiKogyoBus.UrawaMisonoEkiNishiguchi.2248.99","title":"浦和美園駅西口","number":"99","lat":35.89402,"lon":139.7273},{"id":"odpt.BusstopPole:KokusaiKogyoBus.AzumamachiIchiChoume.2004.2","title":"東町一丁目（大宮区）","number":"2","lat":35.90763,"lon":139.6336}]'),v="https://api-challenge.odpt.org/api/v4/odpt:BusroutePattern",P="https://api-challenge.odpt.org/api/v4/odpt:BusstopPole?",b="38yvl7tj03smk5x53o5apu5uwquy3wf9zn1k1szda2wtohgzavjanbu6q9ic3l2c",j=v.split("?")[0],$=P.split("?")[0],C=["#e11d48","#2563eb","#059669","#d97706","#7c3aed","#0ea5e9","#84cc16","#ec4899","#f97316","#14b8a6"],x="odpt.Operator:KokusaiKogyoBus",B=new Map;let A=!1;const w=new Map;let M=!1,h=new Set,y=!0;const S=(_??[]).filter(o=>typeof o.lat=="number"&&typeof o.lon=="number").map(o=>({id:o.id,name:o.title,area:"route",position:{x:0,y:0},coordinates:{lat:o.lat,lng:o.lon},operator:"kokusai",isDropOffOnly:!1,isOmiyaStation:!1,destinations:[],routes:[],number:o.number}));S.forEach(o=>{B.set(o.id,{lat:o.coordinates.lat,lon:o.coordinates.lng,patterns:[]})});function z(o){return S.find(t=>t.id===o)}function W(){return[]}async function Z(o){await J();const t=B.get(o);if(t?.patterns&&t.patterns.length>0)return[...new Set(t.patterns)];const s=new URL($||P);s.searchParams.set("owl:sameAs",o),s.searchParams.set("odpt:operator",x),s.searchParams.set("acl:consumerKey",b),console.log("[ODPT] BusstopPole request",s.toString());const e=await fetch(s.toString());if(console.log("[ODPT] BusstopPole status",e.status),!e.ok)throw new Error(`BusstopPole fetch failed: ${e.status}`);const i=await e.json();console.log("[ODPT] BusstopPole response",i?.length??0,"records");const n=new Set;i.forEach(u=>{(u["odpt:busroutePattern"]||u["odpt:busRoutePattern"]||[]).forEach(r=>n.add(r))});const l=Array.from(n);return B.set(o,{...t||{},patterns:l}),l}async function U(o){const t=B.get(o);if(t&&typeof t.lat=="number"&&typeof t.lon=="number")return t;const s=new URL($||P);s.searchParams.set("owl:sameAs",o),s.searchParams.set("odpt:operator",x),s.searchParams.set("acl:consumerKey",b),console.log("[ODPT] BusstopPole detail request",s.toString());const e=await fetch(s.toString());if(console.log("[ODPT] BusstopPole detail status",e.status),!e.ok)throw new Error(`BusstopPole detail fetch failed: ${e.status}`);const i=await e.json();console.log("[ODPT] BusstopPole detail response",o,i?.length??0,"records");const n=i[0];if(!n)return null;const l=n["geo:lat"]??n["odpt:latitude"],u=n["geo:long"]??n["odpt:longitude"],d=n["odpt:busroutePattern"]||n["odpt:busRoutePattern"]||[];return typeof l=="number"&&typeof u=="number"?(B.set(o,{lat:l,lon:u,patterns:d}),{lat:l,lon:u,patterns:d}):{lat:void 0,lon:void 0,patterns:d}}async function V(o){const t=w.get(o);if(t)return t;if(M)return w.get(o)||null;const s=async r=>{const p=new URL(j||v);p.searchParams.set("odpt:busroutePattern",o),p.searchParams.set("acl:consumerKey",b),r&&p.searchParams.set("odpt:operator",x),console.log("[ODPT] Pattern request",p.toString());const m=await fetch(p.toString());if(console.log("[ODPT] Pattern status",m.status,"operator:",r?"set":"none"),!m.ok)throw new Error(`Pattern fetch failed: ${m.status}`);const N=await m.json();return console.log("[ODPT] Pattern response",o,N?.length??0,"records"),N};let e=await s(!1);if(!e||e.length===0)try{e=await s(!0)}catch(r){console.error("Pattern fetch with operator failed",r)}const i=e&&e[0];if(!i)return console.warn("[ODPT] Pattern not found",o),null;const n=i["odpt:busstopPoleOrder"]||i["odpt:busStopPoleOrder"]||[],l=[],u=[];for(const r of n){const p=r["odpt:busstopPole"]||r["odpt:busStopPole"];if(!p)continue;u.push(p);const m=await U(p);m&&typeof m.lat=="number"&&typeof m.lon=="number"&&l.push([m.lat,m.lon])}const d={id:o,coords:l,stops:u};return w.set(o,d),d}async function J(){if(A||!P||!b)return;const o=new URL($||P);o.searchParams.set("odpt:operator",x),o.searchParams.set("acl:consumerKey",b),console.log("[ODPT] BusstopPole ALL request",o.toString());try{const t=await fetch(o.toString());if(console.log("[ODPT] BusstopPole ALL status",t.status),!t.ok)throw new Error(`BusstopPole ALL fetch failed: ${t.status}`);const s=await t.json();console.log("[ODPT] BusstopPole ALL response",s?.length??0,"records"),Array.isArray(s)&&s.forEach(e=>{const i=e["owl:sameAs"]||e["odpt:busstopPole"],n=e["geo:lat"]??e["odpt:latitude"],l=e["geo:long"]??e["odpt:longitude"],u=e["odpt:busroutePattern"]||e["odpt:busRoutePattern"]||[];i&&typeof n=="number"&&typeof l=="number"&&B.set(i,{lat:n,lon:l,patterns:u})}),A=!0}catch(t){console.error("BusstopPole ALL fetch error",t)}}async function X(){if(M||!v||!b)return;const o=new URL(j||v);o.searchParams.set("odpt:operator",x),o.searchParams.set("acl:consumerKey",b),console.log("[ODPT] BusroutePattern ALL request",o.toString());try{const t=await fetch(o.toString());if(console.log("[ODPT] BusroutePattern ALL status",t.status),!t.ok)throw new Error(`BusroutePattern ALL fetch failed: ${t.status}`);const s=await t.json();if(console.log("[ODPT] BusroutePattern ALL response",s?.length??0,"records"),Array.isArray(s))for(const e of s){const i=e["owl:sameAs"]||e["@id"];if(!i)continue;const n=e["odpt:busstopPoleOrder"]||e["odpt:busStopPoleOrder"]||[],l=[],u=[];for(const d of n){const r=d["odpt:busstopPole"]||d["odpt:busStopPole"];if(!r)continue;u.push(r);const p=B.get(r)||await U(r);p&&typeof p.lat=="number"&&typeof p.lon=="number"&&l.push([p.lat,p.lon])}w.set(i,{id:i,coords:l,stops:u})}M=!0}catch(t){console.error("BusroutePattern ALL fetch error",t)}}function K(){c&&(a.routeLayers.forEach(o=>c.removeLayer(o)),a.routeLayers=[],h=new Set,O())}function oo(o,t,s){if(!c)return;if(!t||t.length<2){console.warn("[ODPT] Pattern has insufficient coords",o);return}const e=L.polyline(t,{color:s,weight:5,opacity:.7}).addTo(c);e.bindPopup(`パターン: ${o}`),a.routeLayers.push(e)}async function to(o){if(K(),h=new Set,!(!o||!c))try{await J(),await X();const t=await Z(o.id),s=await Promise.all(t.map(e=>V(e)));console.log("[ODPT] Drawing patterns",t),s.forEach((e,i)=>{if(!e||!e.coords||e.coords.length<2)return;const n=C[i%C.length];oo(e.id,e.coords,n),e.stops?.forEach(l=>h.add(l))}),O(),f()}catch(t){console.error("パターン取得に失敗しました",t)}}let a={selectedStop:null,searchQuery:"",isMobile:window.innerWidth<1024,markers:new Map,routeLayers:[],drawerHeight:"collapsed",expandedRoutes:new Set,currentTime:new Date},c=null;document.addEventListener("DOMContentLoaded",()=>{lucide.createIcons(),ao(),q(),io()});window.addEventListener("resize",()=>{const o=window.innerWidth<1024;a.isMobile!==o?(a.isMobile=o,q()):c&&c.invalidateSize()});function q(){const o=document.getElementById("desktop-view"),t=document.getElementById("mobile-view");a.isMobile?(o.style.display="none",t.style.display="flex",R("map-mobile"),eo()):(o.style.display="block",t.style.display="none",R("map-desktop"),Y(),E())}function R(o){c&&(c.remove(),a.markers.clear()),c=L.map(o,{center:[35.9065,139.624],zoom:16,zoomControl:!a.isMobile}),L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"© OpenStreetMap contributors",maxZoom:19}).addTo(c);const t=L.divIcon({className:"station-marker",html:`
      <div style="
        width: 48px;
        height: 48px;
        background: linear-gradient(135deg, #1e40af 0%, #4f46e5 100%);
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        border: 3px solid white;
      ">
        <div style="color: white; font-weight: bold; font-size: 12px; text-align: center; line-height: 1.2;">
          JR<br/>大宮
        </div>
      </div>
    `,iconSize:[48,48],iconAnchor:[24,24]});L.marker([35.9065,139.624],{icon:t}).addTo(c).bindPopup("<strong>JR大宮駅</strong><br/>Omiya Station"),f()}function f(){if(!c)return;let o=H(a.searchQuery);y&&h.size>0&&(o=o.filter(t=>h.has(t.id))),a.markers.forEach((t,s)=>{o.find(e=>e.id===s)||(c.removeLayer(t),a.markers.delete(s))}),o.forEach(t=>{let s=a.markers.get(t.id);const e=a.selectedStop?.id===t.id,i=h.size===0?!1:h.has(t.id),n=i?"#0ea5e9":t.area==="east"?"#2563eb":t.area==="west"?"#9333ea":"#8b5cf6",l=t.operator==="tobu"?"#00A040":t.operator==="seibu"?"#FFD700":"#E60012",u=`
      <div style="position: relative;">
        ${e?`
          <div style="
            position: absolute;
            width: 56px;
            height: 56px;
            background: ${n};
            border-radius: 50%;
            animation: pulse 1.5s ease-out infinite;
            opacity: 0.75;
            top: -8px;
            left: -8px;
          "></div>
        `:""}
        <div style="
          width: ${e||t.isDropOffOnly?"40px":"32px"};
          height: ${e||t.isDropOffOnly?"40px":"32px"};
          background: ${t.isDropOffOnly?"#f97316":n};
          border-radius: ${i?"12px":"50%"};
          display: flex;
          align-items: center;
          justify-content: center;
          box-shadow: 0 ${e?"6px 20px":"4px 12px"} rgba(0,0,0,0.4);
          border: ${e||t.isDropOffOnly?"4px":"3px"} solid white;
          cursor: ${t.isDropOffOnly?"not-allowed":"pointer"};
          transition: all 0.3s ease;
          position: relative;
          z-index: ${e?"1000":"1"};
        ">
          ${t.isDropOffOnly?'<div style="width: 24px; height: 3px; background: white; transform: rotate(45deg); border-radius: 2px;"></div>':`<div style="width: ${e?"12px":"10px"}; height: ${e?"12px":"10px"}; background: white; border-radius: ${i?"8px":"50%"}; box-shadow: 0 0 4px rgba(0,0,0,0.2);"></div>`}
        </div>
        ${t.isDropOffOnly?"":`
          <div style="
            position: absolute;
            top: ${e?"-2px":"-3px"};
            right: ${e?"-2px":"-3px"};
            width: ${e?"18px":"14px"};
            height: ${e?"18px":"14px"};
            background: ${l};
            border-radius: 50%;
            border: 3px solid white;
            box-shadow: 0 2px 6px rgba(0,0,0,0.3);
          "></div>
        `}
      </div>
    `,d=L.divIcon({className:"bus-stop-marker",html:u,iconSize:[e?40:32,e?40:32],iconAnchor:[e?20:16,e?20:16],popupAnchor:[0,e?-20:-16]});if(s)s.setIcon(d),s.setZIndexOffset(e?1e3:0);else{s=L.marker([t.coordinates.lat,t.coordinates.lng],{icon:d,title:t.name});const r=`
        <div style="min-width: 200px; font-family: ui-sans-serif, system-ui, sans-serif;">
          <strong style="font-size: 14px; display: block; margin-bottom: 4px;">${t.name}</strong>
          <div style="font-size: 11px; color: #666; margin-bottom: 4px;">
            停留所番号: ${t.number??"-"}
          </div>
          <div style="font-size: 11px; color: #6b7280;">国際興業バス</div>
        </div>
      `;s.bindPopup(r),t.isDropOffOnly||s.on("click",()=>{T(t)}),s.addTo(c),a.markers.set(t.id,s)}})}function H(o){if(!o)return S;const t=o.toLowerCase();return S.filter(s=>s.name.toLowerCase().includes(t)||s.destinations.some(e=>e.toLowerCase().includes(t)))}function T(o){a.selectedStop=o,a.expandedRoutes.clear(),f(),to(o),a.isMobile?g("peek"):E()}function k(o){a.searchQuery=o,f(),a.isMobile?so():F()}function Y(){const o=document.getElementById("desktop-search-input"),t=document.getElementById("desktop-search-clear");o.value!==a.searchQuery&&(o.value=a.searchQuery),a.searchQuery?(t.classList.remove("hidden"),F()):(t.classList.add("hidden"),document.getElementById("desktop-search-results").classList.add("hidden"),document.getElementById("desktop-quick-stats").classList.remove("hidden"))}function F(){const o=document.getElementById("desktop-search-results"),t=document.getElementById("desktop-quick-stats");if(!a.searchQuery){o.classList.add("hidden"),t.classList.remove("hidden");return}t.classList.add("hidden"),o.classList.remove("hidden");const s=H(a.searchQuery);if(s.length===0){o.innerHTML=`
      <div class="p-8 text-center text-gray-500">
        <i data-lucide="search" class="w-12 h-12 text-gray-300 mx-auto mb-2"></i>
        <p>検索結果が見つかりませんでした</p>
      </div>
    `,lucide.createIcons();return}o.innerHTML=`
    <div class="divide-y divide-gray-100">
      ${s.map(e=>`
          <button
            onclick="window.selectStop('${e.id}')"
            class="w-full p-3 text-left hover:bg-gray-50 transition-colors flex items-start gap-3 ${e.isDropOffOnly?"opacity-50 cursor-not-allowed":""}"
            ${e.isDropOffOnly?"disabled":""}
          >
            <div class="mt-1">
              <i data-lucide="map-pin" class="w-5 h-5 text-teal-600"></i>
            </div>
            <div class="flex-1 min-w-0">
              <div class="flex items-center gap-2 mb-1">
                <h4 class="text-gray-900">${e.name}</h4>
                <span class="px-2 py-0.5 bg-teal-100 text-teal-700 text-xs rounded">停留所</span>
                <span class="text-xs text-gray-500">国際興業</span>
                ${e.isDropOffOnly?'<span class="px-2 py-0.5 bg-orange-100 text-orange-700 text-xs rounded">降車専用</span>':""}
              </div>
              ${!e.isDropOffOnly&&e.destinations.length>0?`<p class="text-sm text-gray-500 truncate">${e.destinations.slice(0,3).join(" / ")}${e.destinations.length>3?" 他":""}</p>`:""}
            </div>
          </button>
        `).join("")}
    </div>
  `,lucide.createIcons()}window.selectStop=o=>{const t=z(o);t&&!t.isDropOffOnly&&(T(t),a.isMobile||(k(""),Y()))};function E(){const o=document.getElementById("desktop-default-msg"),t=document.getElementById("desktop-selected-content"),s=document.getElementById("desktop-route-panel"),e=document.getElementById("desktop-departure-board");if(!a.selectedStop){K(),o.classList.remove("hidden"),t.classList.add("hidden");return}o.classList.add("hidden"),t.classList.remove("hidden"),s.innerHTML=Q(a.selectedStop),e.innerHTML=G(a.selectedStop),lucide.createIcons()}function Q(o){return o.isDropOffOnly?`
      <div class="bg-white rounded-2xl overflow-hidden p-10 text-center">
        <div class="w-20 h-20 bg-orange-100 border-2 border-orange-200 rounded-2xl flex items-center justify-center mx-auto mb-4">
          <svg class="w-10 h-10 text-orange-600" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M13.477 14.89A6 6 0 015.11 6.524l8.367 8.368zm1.414-1.414L6.524 5.11a6 6 0 018.367 8.367zM18 10a8 8 0 11-16 0 8 8 0 0116 0z" clip-rule="evenodd" />
          </svg>
        </div>
        <h3 class="text-lg text-gray-900 mb-2 font-semibold">降車専用バス停</h3>
        <p class="text-sm text-gray-600">このバス停からは乗車できません</p>
      </div>
    `:o.routes.length===0?"":`
    <div class="bg-white rounded-2xl overflow-hidden p-4">
      <h3 class="text-gray-900 mb-3 flex items-center gap-2 font-semibold">
        <div class="w-9 h-9 bg-green-600 rounded-xl flex items-center justify-center">
          <i data-lucide="bus" class="w-5 h-5 text-white"></i>
        </div>
        運行系統
      </h3>
      <div class="space-y-3">
        ${o.routes.map(t=>"").join("")}
      </div>
    </div>
  `}window.toggleRoute=o=>{a.expandedRoutes.has(o)?a.expandedRoutes.delete(o):a.expandedRoutes.add(o),a.isMobile?I():E()};function G(o){const t=W(o.id);if(o.isDropOffOnly||t.length===0)return o.isDropOffOnly?"":`
      <div class="bg-white rounded-2xl overflow-hidden p-10 text-center">
        <div class="w-16 h-16 bg-gray-100 rounded-2xl flex items-center justify-center mx-auto mb-3">
          <i data-lucide="clock" class="w-8 h-8 text-gray-400"></i>
        </div>
        <p class="text-gray-900 font-medium mb-1">発車予定なし</p>
        <p class="text-sm text-gray-500">現在、発車予定のバスはありません</p>
      </div>
    `;const s=t[0];return`
    <div class="bg-white rounded-2xl overflow-hidden">
      <!-- Header -->
      <div class="mb-4 pt-4 px-4">
        <div class="flex items-center gap-2">
          <div class="w-9 h-9 bg-indigo-600 rounded-xl flex items-center justify-center">
            <i data-lucide="clock" class="w-5 h-5 text-white"></i>
          </div>
          <h2 class="text-lg text-gray-900 font-semibold">発車時刻</h2>
        </div>
      </div>

      <!-- Next Departure -->
      <div class="px-4">
        <div class="p-5 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-2xl mb-4 shadow-lg">
          <div class="flex items-center gap-2 mb-3">
            <i data-lucide="radio" class="w-4 h-4 text-white animate-pulse"></i>
            <span class="text-xs text-white font-semibold uppercase tracking-wide">次の発車</span>
          </div>
          <div class="flex items-baseline gap-3 mb-3">
            <span class="text-4xl text-white font-bold">${s.departureTime}</span>
            ${s.delay?`
              <div class="flex items-center gap-1 bg-white/20 backdrop-blur-sm px-3 py-1.5 rounded-full">
                <i data-lucide="trending-up" class="w-4 h-4 text-white"></i>
                <span class="text-sm text-white font-semibold">+${s.delay}分</span>
              </div>
            `:""}
          </div>
          <div class="flex items-center gap-2">
            <span class="px-3 py-1.5 bg-white text-blue-600 text-sm font-semibold rounded-lg">
              ${s.routeName}
            </span>
            <span class="text-sm text-white font-medium">${s.destination}</span>
          </div>
        </div>
      </div>

      <!-- List -->
      <div class="max-h-64 overflow-y-auto px-4 pb-4">
        <div class="divide-y divide-gray-100 border-2 border-gray-200 rounded-2xl overflow-hidden">
          ${t.slice(1).map(e=>`
            <div class="p-4 hover:bg-blue-50 transition-colors flex items-center justify-between">
              <div class="flex items-center gap-4 flex-1">
                <span class="text-xl text-gray-900 font-semibold w-16">${e.departureTime}</span>
                <span class="px-3 py-1 bg-gray-100 text-gray-700 text-sm font-medium rounded-lg">${e.routeName}</span>
                <span class="text-sm text-gray-700 flex-1 truncate font-medium">${e.destination}</span>
              </div>
              ${e.delay?`
                <span class="text-sm text-orange-600 flex items-center gap-1 bg-orange-50 px-2 py-1 rounded-lg font-semibold">
                  <i data-lucide="trending-up" class="w-3 h-3"></i>+${e.delay}
                </span>
              `:""}
            </div>
          `).join("")}
        </div>
      </div>
      
      <!-- Footer -->
       <div class="p-4">
          <div class="p-4 bg-blue-50 border border-blue-100 rounded-2xl">
            <div class="flex items-center gap-2 text-sm text-blue-700">
              <i data-lucide="radio" class="w-4 h-4"></i>
              <span class="font-medium">リアルタイム情報は参考値です</span>
            </div>
          </div>
       </div>
    </div>
  `}function eo(){document.getElementById("mobile-search-collapsed"),document.getElementById("mobile-search-expanded"),document.getElementById("mobile-search-results")}function so(){const o=H(a.searchQuery),t=document.getElementById("mobile-search-results");if(!a.searchQuery){t.innerHTML="";return}o.length===0?t.innerHTML=`
      <div class="p-10 text-center text-gray-500">
        <div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-3">
          <i data-lucide="search" class="w-8 h-8 text-gray-400"></i>
        </div>
        <p class="text-gray-900 mb-1">検索結果が見つかりません</p>
        <p class="text-sm text-gray-500">別のキーワードをお試しください</p>
      </div>
    `:t.innerHTML=`
      <div class="divide-y divide-gray-100">
        ${o.map(s=>`
            <button
              onclick="window.selectStopMobile('${s.id}')"
              class="w-full p-4 text-left transition-colors ${s.isDropOffOnly?"opacity-50":"hover:bg-blue-50 active:bg-blue-100"}"
              ${s.isDropOffOnly?"disabled":""}
            >
              <div class="flex items-center gap-2 mb-2">
                <span class="text-gray-900 font-medium">${s.name}</span>
                <span class="px-2.5 py-1 bg-teal-500 text-white text-xs rounded-full font-medium">停留所</span>
                ${s.isDropOffOnly?'<span class="px-2.5 py-1 bg-orange-500 text-white text-xs rounded-full font-medium">降車専用</span>':""}
              </div>
              ${!s.isDropOffOnly&&s.destinations.length>0?`<p class="text-sm text-gray-600 line-clamp-1">${s.destinations.slice(0,3).join(" • ")}</p>`:""}
            </button>
          `).join("")}
      </div>
    `,lucide.createIcons()}window.selectStopMobile=o=>{const t=z(o);t&&(T(t),D(!1))};function g(o){a.drawerHeight=o;const t=document.getElementById("mobile-drawer");let s="translateY(100%)";o==="peek"&&(s="translateY(calc(100% - 280px))"),o==="half"&&(s="translateY(50%)"),o==="full"&&(s="translateY(0)"),t.style.transform=s,a.selectedStop?I():K()}function I(){const o=a.selectedStop,t=document.getElementById("mobile-drawer-header");document.getElementById("mobile-drawer-body");const s=document.getElementById("mobile-stop-content"),e=document.getElementById("mobile-info-content"),i=document.getElementById("mobile-drawer-title"),n=document.getElementById("mobile-drawer-badges");if(!o){t.classList.add("hidden"),s.classList.add("hidden"),e.classList.remove("hidden");return}t.classList.remove("hidden"),e.classList.add("hidden"),s.classList.remove("hidden"),i.innerText=o.name;const l="bg-teal-500 text-white";n.innerHTML=`
    ${o.isOmiyaStation?`<span class="px-3 py-1.5 text-sm rounded-full font-medium ${l}">停留所</span>`:""}
    <span class="text-sm text-gray-600 bg-gray-100 px-3 py-1.5 rounded-full font-medium">
      国際興業バス
    </span>
  `;let u="";o.isOmiyaStation?u+=`
      <div class="bg-gradient-to-br from-blue-50 via-blue-50 to-indigo-50 rounded-2xl p-5 border border-blue-100">
        <h3 class="text-gray-900 mb-3 flex items-center gap-2 font-semibold">
          <div class="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center">
            <svg class="w-5 h-5 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
            </svg>
          </div>
          主な行き先
        </h3>
        ${o.destinations.length>0?`
          <div class="space-y-2">
            ${o.destinations.map((d,r)=>`
              <div class="text-sm text-gray-700 flex items-center gap-3 bg-white rounded-xl p-3">
                <div class="w-6 h-6 bg-blue-600 rounded-full flex items-center justify-center flex-shrink-0">
                  <span class="text-xs text-white font-semibold">${r+1}</span>
                </div>
                <span class="font-medium">${d}</span>
              </div>
            `).join("")}
          </div>
        `:'<p class="text-sm text-gray-500 bg-white rounded-xl p-4 text-center">情報がありません</p>'}
      </div>
      
      <div class="bg-white">
        ${Q(o)}
      </div>
      
      <div class="bg-white">
        ${G(o)}
      </div>
    `:(u+=`
      <div class="bg-gradient-to-br from-purple-50 via-purple-50 to-indigo-50 rounded-2xl p-5 border border-purple-100">
         <h3 class="text-gray-900 mb-3 flex items-center gap-2 font-semibold">
            <div class="w-8 h-8 bg-purple-600 rounded-lg flex items-center justify-center">
              <i data-lucide="navigation" class="w-5 h-5 text-white"></i>
            </div>
            通過する路線
         </h3>
         ${o.routes.length>0?`
            <div class="space-y-2">
               ${o.routes.map(d=>"").join("")}
            </div>
         `:""}
      </div>
     `,o.routes.forEach(d=>{})),s.innerHTML=u,lucide.createIcons()}function D(o){const t=document.getElementById("mobile-search-collapsed"),s=document.getElementById("mobile-search-expanded"),e=document.getElementById("mobile-search-results"),i=document.getElementById("mobile-search-input");o?(t.classList.add("hidden"),s.classList.remove("hidden"),e.classList.remove("hidden"),i.focus(),g("collapsed")):(t.classList.remove("hidden"),s.classList.add("hidden"),e.classList.add("hidden"),i.value="",k(""))}function io(){const o=()=>{a.currentTime=new Date;const t=a.currentTime.toLocaleTimeString("ja-JP",{hour:"2-digit",minute:"2-digit"});document.querySelectorAll(".time-display").forEach(s=>s.textContent=t),a.selectedStop&&(a.isMobile?I():E())};setInterval(o,6e4),o()}function ao(){const o=document.getElementById("desktop-search-input");o.addEventListener("input",l=>k(l.target.value)),document.getElementById("desktop-search-clear").addEventListener("click",()=>{o.value="",k(""),document.getElementById("desktop-search-input").focus()}),document.getElementById("mobile-search-btn").addEventListener("click",()=>D(!0)),document.getElementById("mobile-search-close-btn").addEventListener("click",()=>D(!1)),document.getElementById("mobile-search-input").addEventListener("input",l=>k(l.target.value)),document.getElementById("mobile-drawer-handle");const t=document.getElementById("mobile-drawer");let s=0,e=0,i=!1;t.addEventListener("touchstart",l=>{(l.target.closest("#mobile-drawer-handle")||l.target===t)&&(s=l.touches[0].clientY,i=!0)}),document.addEventListener("touchmove",l=>{i&&(e=l.touches[0].clientY)}),document.addEventListener("touchend",l=>{if(!i)return;i=!1;const u=s-e;Math.abs(u)>50&&(u>0?a.drawerHeight==="peek"?g("half"):a.drawerHeight==="half"&&g("full"):a.drawerHeight==="full"?g("half"):a.drawerHeight==="half"?g("peek"):a.drawerHeight==="peek"&&(a.selectedStop=null,g("collapsed"),K())),s=0,e=0}),document.getElementById("mobile-info-btn").addEventListener("click",()=>{a.selectedStop=null,K(),I(),g("half")}),document.getElementById("mobile-drawer-close-btn").addEventListener("click",()=>{a.selectedStop=null,K(),g("collapsed"),f()}),[document.getElementById("route-toggle-btn-desktop"),document.getElementById("route-toggle-btn-mobile")].forEach(l=>{l&&l.addEventListener("click",()=>{y=!y,O(),f()})}),O()}function O(){const o=y?"ルート上のみ":"全停留所";[document.getElementById("route-toggle-btn-desktop"),document.getElementById("route-toggle-btn-mobile")].forEach(s=>{s&&(s.textContent=o,s.classList.toggle("bg-teal-600",y),s.classList.toggle("bg-gray-200",!y),s.classList.toggle("text-white",y),s.classList.toggle("text-gray-700",!y))})}
